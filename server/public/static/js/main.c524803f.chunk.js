(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{115:function(e,t,n){},148:function(e,t,n){},149:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n(0),r=n.n(a),i=n(12),o=n.n(i),s=(n(115),n(8)),u=n(96),l=n(215),d=n(209),j=n(21),b=n(210),f=n(151),h=n(191),O=n(193),p=n(194),x=n(195),m=n(45),g=n.n(m),v=n(189),y=n(4),k="https://shopping-list-cqrs.herokuapp.com",w=function(e){return fetch("".concat(k,"/events"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})},C=function(e){var t=e.newProductName,n=e.newProductCategory;return fetch("".concat(k,"/products"),{method:"POST",body:JSON.stringify({name:t,category:n}),headers:{"Content-Type":"application/json"}})},S=n(13),N=Object(S.atom)({key:"products",default:[]}),_=Object(S.atom)({key:"shoppingList",default:[]}),R=Object(S.atom)({key:"listId",default:"1"}),T=Object(S.atom)({key:"listData",default:new Map}),B=Object(S.selector)({key:"listItems",get:function(e){var t=e.get,n=t(R),c=t(T).get(n)||[];return console.log(c),c}}),E=n(70),I=n(16),W=n.n(I),L=n(36),P=function(){var e=Object(S.useRecoilState)(T),t=Object(s.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),i=Object(s.a)(r,2),o=i[0],u=i[1],l=Object(S.useRecoilValue)(R),d=Object(S.useRecoilValue)(B);Object(a.useEffect)((function(){if(!o){var e=new EventSource("".concat(k,"/list-data"));e.onmessage=function(){var e=Object(L.a)(W.a.mark((function e(t){var n,a,r,i;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=JSON.parse(t.data),a=new Response(t.data,{headers:{"content-type":"application/json"}}),r=new Map(Object.entries(n)),c(r),!window.caches){e.next=10;break}return e.next=7,window.caches.open("shoppinglist");case 7:return i=e.sent,e.next=10,i.put("/events/".concat(l),a).catch((function(e){return console.log(e)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.onerror=function(){var e=Object(L.a)(W.a.mark((function e(t){var n,a,r;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.caches){e.next=9;break}return e.next=3,window.caches.match("/events/".concat(l));case 3:return n=e.sent,e.next=6,null===n||void 0===n?void 0:n.json();case 6:a=e.sent,r=new Map(Object.entries(a)),c(r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u(!0)}}),[o,l]);return function(e){var t=d.map((function(t){return t.id===e?Object(E.a)(Object(E.a)({},t),{},{checked:!t.checked}):t})),a=new Map(n);a.set(l,t),c(a)}},K=["Obst","Gem\xfcse","K\xfchlwaren","Fleisch","TK","Konserven","Trockenware","W\xfcrzwaren","Backwaren","Backzutaten","Getr\xe4nke","Snacks","Drogerie"],D=n(196),F=Object(v.a)((function(e){return{listItemChecked:{background:e.palette.secondary.light,textDecoration:"line-through"},list:{overflow:"auto",maxHeight:"calc(100vh - 140px)"},button:{marginTop:"auto"},listItemText:{display:"flex","& .MuiListItemText-secondary":{marginLeft:"1em"}}}}));function M(e){var t=Object(S.useRecoilState)(R),n=Object(s.a)(t,2),r=n[0],i=n[1],o=Object(S.useRecoilValue)(B),u=F(),l=u.listItemChecked,d=u.list,m=u.button,v=u.listItemText,k=P(),C=Object(a.useState)(!1),N=Object(s.a)(C,2),_=N[0],T=N[1];Object(a.useEffect)((function(){e.id&&e.id!==r&&i(e.id)}),[r,i,e.id]);return Object(c.jsxs)(b.a,{children:[Object(c.jsx)(b.a,{p:2,children:Object(c.jsx)(h.a,{align:"center",display:"block",component:j.a,to:"edit",children:"Bearbeiten"})}),Object(c.jsx)(O.a,{className:d,children:o.slice().filter((function(e){return!_||!e.checked})).sort((function(e,t){return K.indexOf(e.category)-K.indexOf(t.category)})).map((function(e){return Object(c.jsxs)(f.a,{onClick:function(){return function(e){k(e.id);var t={list_id:r,product_id:e.id,type:""};return e.checked?t.type="item_unchecked":t.type="item_checked",w(t)}(e)},className:Object(y.a)(e.checked?l:""),children:[Object(c.jsx)(p.a,{children:Object(c.jsx)(g.a,{})}),Object(c.jsx)(x.a,{className:v,primary:e.name,secondary:e.quantity})]},e.id)}))}),Object(c.jsx)(b.a,{className:m,display:"flex",justifyContent:"center",children:Object(c.jsx)(D.a,{onClick:function(){return T(!_)},children:_?"Fertige einblenden":"Fertige ausblenden"})})]})}var G=n(90),V=n.n(G),q=n(216),J=n(89),z=Object(v.a)((function(e){return{listItemChecked:{background:e.palette.secondary.light},chipContainer:{height:"68px",overflowX:"scroll"},list:{overflow:"auto",maxHeight:"calc(100vh - 185px)"},listItemText:{display:"flex","& .MuiListItemText-secondary":{marginLeft:"1em"}}}}));function A(e){var t=z(),n=t.listItemChecked,r=t.chipContainer,i=t.list,o=t.listItemText,u=Object(a.useState)([]),l=Object(s.a)(u,2),d=l[0],m=l[1],v=Object(S.useRecoilValue)(N),k=Object(S.useRecoilValue)(B),C=Object(S.useRecoilValue)(R),_=Array.from(new Set(v.map((function(e){return e.category}))));return Object(c.jsxs)(b.a,{children:[Object(c.jsx)(b.a,{p:2,children:Object(c.jsx)(h.a,{align:"center",display:"block",component:j.a,to:"/list/".concat(C),children:"Fertig"})}),Object(c.jsx)(b.a,{p:1,display:"flex",justifyContent:"space-between",alignItems:"space-between",flexDirection:"column",flexWrap:"wrap",className:r,children:_.sort((function(e,t){return K.indexOf(e)-K.indexOf(t)})).map((function(e){return Object(c.jsx)(q.a,{icon:Object(c.jsx)(g.a,{}),label:e,color:d.includes(e)?"primary":"default",onClick:function(){return function(e){var t=d.includes(e)?d.filter((function(t){return t!==e})):[e];return m(t)}(e)},clickable:!0},e)}))}),Object(c.jsx)(O.a,{className:i,children:v.filter((function(e){return!(d.length>0)||d.includes(e.category)})).sort((function(e,t){return K.indexOf(e.category)-K.indexOf(t.category)})).map((function(e){var t,a=k.some((function(t){return t.id===e.id})),r=null===(t=k.find((function(t){return t.id===e.id})))||void 0===t?void 0:t.quantity;return Object(c.jsx)(J.a,{onSwipedLeft:function(){return function(e){var t=k.find((function(t){return t.id===e.id}));return 1==(null===t||void 0===t?void 0:t.quantity)?w({list_id:C,product_id:e.id,type:"item_removed"}):(null===t||void 0===t?void 0:t.quantity)>1?w({list_id:C,product_id:e.id,type:"quantity_dec"}):void 0}(e)},onSwipedRight:function(){return function(e){var t=k.find((function(t){return t.id===e.id}));return w(t?{list_id:C,product_id:e.id,type:"quantity_inc"}:{list_id:C,product_id:e.id,type:"item_added"})}(e)},trackMouse:!0,children:Object(c.jsxs)(f.a,{button:!0,focusVisibleClassName:a?n:"",className:Object(y.a)(a?n:""),children:[Object(c.jsx)(p.a,{children:Object(c.jsx)(g.a,{})}),Object(c.jsx)(x.a,{className:o,primary:e.name,secondary:a?r:""}),a&&Object(c.jsx)(V.a,{})]},e.id)})}))})]})}var H=n(91),U=n.n(H),Z=n(92),X=n.n(Z),$=n(198),Q=n(93),Y=n.n(Q),ee=n(94),te=n.n(ee),ne=n(71),ce=n.n(ne),ae=n(197),re=n(213),ie=n(214),oe=n(204),se=n(200),ue=n(201),le=n(199),de=n(211),je=n(205),be=function(){var e=Object(S.useRecoilValue)(B),t=Object(S.useRecoilState)(N),n=Object(s.a)(t,2),c=n[0],a=n[1];return[c,function(){fetch("".concat(k,"/products")).then((function(e){return e.json()})).then((function(t){var n=t.data.map((function(t){return{id:String(t.id),name:t.product_name,category:t.category,selected:e.some((function(e){return e.id==="".concat(t.id)}))}}));a(n)}))}]},fe=function(){var e=Object(S.useRecoilState)(_),t=Object(s.a)(e,2),n=t[0],c=t[1];return[n,function(){fetch("".concat(k,"/lists")).then((function(e){return e.json()})).then((function(e){return c(e.data)}))}]},he=Object(v.a)((function(e){return{root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},nested:{paddingLeft:e.spacing(4)},isDeleted:{backgroundColor:e.palette.secondary.dark}}}));function Oe(e){var t=he(),n=r.a.useState(!0),a=Object(s.a)(n,2),i=a[0],o=a[1],u=r.a.useState(!1),l=Object(s.a)(u,2),d=l[0],h=l[1],m=r.a.useState(!1),g=Object(s.a)(m,2),v=g[0],y=g[1],k=r.a.useState(!1),S=Object(s.a)(k,2),N=S[0],_=S[1],R=r.a.useState(""),T=Object(s.a)(R,2),B=T[0],E=T[1],I=r.a.useState(""),P=Object(s.a)(I,2),K=P[0],F=P[1],M=r.a.useState(""),G=Object(s.a)(M,2),V=G[0],q=G[1],J=r.a.useState(""),z=Object(s.a)(J,2),A=z[0],H=z[1],Z=be(),Q=Object(s.a)(Z,2),ee=(Q[0],Q[1]),ne=fe(),Oe=Object(s.a)(ne,2),pe=Oe[0],xe=Oe[1],me=function(){return h(!1)},ge=function(){y(!1)},ve=function(){var e=Object(L.a)(W.a.mark((function e(){var t;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(me(),B.trim()){e.next=3;break}return e.abrupt("return");case 3:return E(""),t={type:"list_added",name:B},e.next=7,w(t);case 7:return e.abrupt("return",xe());case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=function(){var e=Object(L.a)(W.a.mark((function e(){var t;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ge(),K.trim()){e.next=3;break}return e.abrupt("return");case 3:return F(""),t={type:"list_removed",list_id:K},xe(),e.next=8,w(t);case 8:return e.abrupt("return",xe());case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=Object(L.a)(W.a.mark((function e(){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(!1),V.trim()){e.next=3;break}return e.abrupt("return");case 3:if(A.trim()){e.next=5;break}return e.abrupt("return");case 5:return q(""),H(""),e.next=9,C({newProductName:V,newProductCategory:A});case 9:return e.abrupt("return",ee());case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.jsxs)(b.a,{className:t.root,children:[Object(c.jsxs)(O.a,{component:"nav","aria-label":"main mailbox folders",children:[Object(c.jsxs)(f.a,{button:!0,children:[Object(c.jsx)(p.a,{children:Object(c.jsx)(U.a,{})}),Object(c.jsx)(x.a,{onClick:function(){return h(!0)},primary:"Neuer Einkaufszettel"})]}),Object(c.jsxs)(f.a,{button:!0,onClick:function(){o(!i)},children:[Object(c.jsx)(p.a,{children:Object(c.jsx)(X.a,{})}),Object(c.jsx)(x.a,{primary:"Einkaufslisten"}),i?Object(c.jsx)(Y.a,{}):Object(c.jsx)(te.a,{})]}),Object(c.jsx)(ae.a,{in:i,timeout:"auto",unmountOnExit:!0,children:Object(c.jsx)(O.a,{component:"div",disablePadding:!0,children:pe.map((function(e){return Object(c.jsxs)(f.a,{component:j.a,to:"/list/".concat(e.id),button:!0,className:t.nested,children:[Object(c.jsx)(p.a,{children:Object(c.jsx)(ce.a,{})}),Object(c.jsx)(x.a,{primary:e.name})]},e.id)}))})})]}),Object(c.jsx)($.a,{}),Object(c.jsxs)(O.a,{component:"nav","aria-label":"secondary mailbox folders",children:[Object(c.jsx)(f.a,{button:!0,children:Object(c.jsx)(x.a,{onClick:function(){return y(!0)},primary:"L\xf6schen"})}),Object(c.jsx)(f.a,{button:!0,children:Object(c.jsx)(x.a,{onClick:function(){return _(!0)},primary:"Neues Produkt"})})]}),Object(c.jsxs)(ie.a,{open:d,onClose:me,"aria-labelledby":"form-dialog-title",children:[Object(c.jsx)(le.a,{id:"form-dialog-title",children:"Neue Liste"}),Object(c.jsxs)(se.a,{children:[Object(c.jsx)(ue.a,{children:"Bitte gib den Namen deiner Einkaufsliste ein."}),Object(c.jsx)(re.a,{autoFocus:!0,margin:"dense",id:"name",value:B,label:"Name",type:"name",fullWidth:!0,onChange:function(e){return E(e.target.value)}})]}),Object(c.jsxs)(oe.a,{children:[Object(c.jsx)(D.a,{onClick:me,color:"primary",children:"Zur\xfcck"}),Object(c.jsx)(D.a,{onClick:ve,color:"primary",children:"OK"})]})]}),Object(c.jsxs)(ie.a,{open:v,onClose:ge,"aria-labelledby":"form-dialog-title",children:[Object(c.jsx)(le.a,{id:"form-dialog-title",children:"Liste l\xf6schen"}),Object(c.jsxs)(se.a,{children:[Object(c.jsx)(ue.a,{children:"Welche Liste m\xf6chtest du l\xf6schen?"}),Object(c.jsx)(O.a,{children:pe.map((function(e){var n=K===e.id;return Object(c.jsxs)(f.a,{onClick:function(){return F(e.id)},button:!0,className:n?t.isDeleted:"",children:[Object(c.jsx)(p.a,{children:Object(c.jsx)(ce.a,{})}),Object(c.jsx)(x.a,{primary:e.name})]},e.id)}))})]}),Object(c.jsxs)(oe.a,{children:[Object(c.jsx)(D.a,{onClick:ge,color:"primary",children:"Zur\xfcck"}),Object(c.jsx)(D.a,{onClick:ye,color:"primary",children:"OK"})]})]}),Object(c.jsxs)(ie.a,{open:N,onClose:_,"aria-labelledby":"form-dialog-title",children:[Object(c.jsx)(le.a,{id:"form-dialog-title",children:"Neues Produkt"}),Object(c.jsxs)(se.a,{children:[Object(c.jsx)(ue.a,{children:"Bitte gib den Namen des neuen Produkts ein."}),Object(c.jsx)(re.a,{autoFocus:!0,margin:"dense",id:"name",value:V,label:"Name",type:"name",fullWidth:!0,onChange:function(e){return q(e.target.value)}}),Object(c.jsx)(ue.a,{children:"Bitte gib die Kategorie des neuen Produkts an"}),Object(c.jsxs)(de.a,{id:"category",value:A,onChange:function(e){var t=e.target.value;H(t)},children:[Object(c.jsx)(je.a,{value:"TK",children:"TK"}),Object(c.jsx)(je.a,{value:"Backwaren",children:"Backwaren"}),Object(c.jsx)(je.a,{value:"K\xfchlwaren",children:"K\xfchlwaren"}),Object(c.jsx)(je.a,{value:"Getr\xe4nke",children:"Getr\xe4nke"}),Object(c.jsx)(je.a,{value:"Trockenware",children:"Trockenware"}),Object(c.jsx)(je.a,{value:"Obst & Gem\xfcse",children:"Obst & Gem\xfcse"}),Object(c.jsx)(je.a,{value:"Drogerie",children:"Drogerie"}),Object(c.jsx)(je.a,{value:"Snacks",children:"Snacks"})]})]}),Object(c.jsxs)(oe.a,{children:[Object(c.jsx)(D.a,{onClick:function(){return _(!1)},color:"primary",children:"Zur\xfcck"}),Object(c.jsx)(D.a,{onClick:ke,color:"primary",children:"OK"})]})]})]})}var pe=n(206),xe=n(207),me=n(37),ge=n(208),ve=n(95),ye=n.n(ve),ke=Object(v.a)((function(e){return{menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function we(){var e=ke();return Object(c.jsx)(b.a,{flexGrow:1,children:Object(c.jsx)(pe.a,{position:"static",children:Object(c.jsxs)(xe.a,{children:[Object(c.jsx)(ge.a,{onClick:function(){return Object(j.c)("/menu")},edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",children:Object(c.jsx)(ye.a,{})}),Object(c.jsx)(me.a,{variant:"h6",className:e.title,children:"Einkaufsliste"})]})})})}var Ce=Object(v.a)((function(){return{page:{boxSizing:"border-box",margin:"0",padding:"0",maxHeight:"100vh",position:"relative",paddingBottom:"10vh"}}}));function Se(e){var t=Ce().page;return Object(c.jsxs)(b.a,{className:t,children:[Object(c.jsx)(we,{}),Object(c.jsxs)(j.b,{children:[Object(c.jsx)(M,{path:"/list/:id"}),Object(c.jsx)(A,{path:"/list/:id/edit"}),Object(c.jsx)(Oe,{path:"/menu"})]})]})}n(148);var Ne=Object(u.a)({palette:{primary:{main:"#57DBBE",light:"#80FFE3"},secondary:{main:"#915540",light:"#DF9379"}},typography:{fontFamily:"\n      Roboto Mono,\n      Roboto,\n      sans-serif\n      "}});Ne=Object(l.a)(Ne);var _e=function(){var e=be(),t=Object(s.a)(e,2),n=(t[0],t[1]),r=fe(),i=Object(s.a)(r,2),o=(i[0],i[1]);return P(),Object(a.useEffect)((function(){n(),o()}),[]),Object(c.jsx)(d.a,{theme:Ne,children:Object(c.jsx)(Se,{})})},Re=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Te(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(S.RecoilRoot,{children:Object(c.jsx)(_e,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Re?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var c=n.headers.get("content-type");404===n.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Te(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Te(t,e)}))}}()}},[[149,1,2]]]);
//# sourceMappingURL=main.c524803f.chunk.js.map