(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{115:function(e,t,n){},148:function(e,t,n){},149:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n(0),r=n.n(c),i=n(12),o=n.n(i),s=(n(115),n(8)),u=n(96),l=n(215),d=n(209),j=n(21),b=n(210),h=n(151),f=n(191),O=n(193),p=n(194),x=n(195),m=n(45),v=n.n(m),g=n(189),y=n(4),k="https://shopping-list-cqrs.herokuapp.com",w=function(e){return fetch("".concat(k,"/events"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})},C=function(e){var t=e.newProductName,n=e.newProductCategory;return fetch("".concat(k,"/products"),{method:"POST",body:JSON.stringify({name:t,category:n}),headers:{"Content-Type":"application/json"}})},S=n(13),N=Object(S.atom)({key:"products",default:[]}),_=Object(S.atom)({key:"shoppingList",default:[]}),R=Object(S.atom)({key:"listId",default:"1"}),T=Object(S.atom)({key:"listData",default:new Map}),B=Object(S.selector)({key:"listItems",get:function(e){var t=e.get,n=t(R),a=t(T).get(n)||[];return console.log(a),a}}),W=n(69),E=n(16),I=n.n(E),K=n(36),L=function(){var e=Object(S.useRecoilState)(T),t=Object(s.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!1),i=Object(s.a)(r,2),o=i[0],u=i[1],l=Object(S.useRecoilValue)(R),d=Object(S.useRecoilValue)(B);Object(c.useEffect)((function(){if(!o){var e=new EventSource("".concat(k,"/list-data"));e.onmessage=function(){var e=Object(K.a)(I.a.mark((function e(t){var n,c,r,i;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=JSON.parse(t.data),c=new Response(t.data,{headers:{"content-type":"application/json"}}),r=new Map(Object.entries(n)),a(r),!window.caches){e.next=10;break}return e.next=7,window.caches.open("shoppinglist");case 7:return i=e.sent,e.next=10,i.put("/events/".concat(l),c).catch((function(e){return console.log(e)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.onerror=function(){var e=Object(K.a)(I.a.mark((function e(t){var n,c,r;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.caches||d){e.next=9;break}return e.next=3,window.caches.match("/events/".concat(l));case 3:return n=e.sent,e.next=6,null===n||void 0===n?void 0:n.json();case 6:c=e.sent,r=new Map(Object.entries(c)),a(r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u(!0)}}),[o,d,l]);return function(e){var t=d.map((function(t){return t.id===e?Object(W.a)(Object(W.a)({},t),{},{checked:!t.checked}):t})),c=new Map(n);c.set(l,t),a(c)}},P=["Obst","Gem\xfcse","K\xfchlwaren","Fleisch","TK","Konserven","Trockenware","W\xfcrzwaren","Backwaren","Backzutaten","Getr\xe4nke","Snacks","Drogerie"],F=n(196),D=Object(g.a)((function(e){return{listItemChecked:{background:e.palette.secondary.light,textDecoration:"line-through"},list:{overflow:"auto",maxHeight:"calc(100vh - 140px)"},button:{marginTop:"auto"},listItemText:{display:"flex","& .MuiListItemText-secondary":{marginLeft:"1em"}}}}));function M(e){var t=Object(S.useRecoilState)(R),n=Object(s.a)(t,2),r=n[0],i=n[1],o=Object(S.useRecoilValue)(B),u=D(),l=u.listItemChecked,d=u.list,m=u.button,g=u.listItemText,k=L(),C=Object(c.useState)(!1),N=Object(s.a)(C,2),_=N[0],T=N[1];Object(c.useEffect)((function(){e.id&&e.id!==r&&i(e.id)}),[r,i,e.id]);return Object(a.jsxs)(b.a,{children:[Object(a.jsx)(b.a,{p:2,children:Object(a.jsx)(f.a,{align:"center",display:"block",component:j.a,to:"edit",children:"Bearbeiten"})}),Object(a.jsx)(O.a,{className:d,children:o.slice().filter((function(e){return!_||!e.checked})).sort((function(e,t){return P.indexOf(e.category)-P.indexOf(t.category)})).map((function(e){return Object(a.jsxs)(h.a,{onClick:function(){return function(e){k(e.id);var t={list_id:r,product_id:e.id,type:""};return e.checked?t.type="item_unchecked":t.type="item_checked",w(t)}(e)},className:Object(y.a)(e.checked?l:""),children:[Object(a.jsx)(p.a,{children:Object(a.jsx)(v.a,{})}),Object(a.jsx)(x.a,{className:g,primary:e.name,secondary:e.quantity})]},e.id)}))}),Object(a.jsx)(b.a,{className:m,display:"flex",justifyContent:"center",children:Object(a.jsx)(F.a,{onClick:function(){return T(!_)},children:_?"Fertige einblenden":"Fertige ausblenden"})})]})}var z=n(90),G=n.n(z),V=n(216),q=n(89),J=Object(g.a)((function(e){return{listItemChecked:{background:e.palette.secondary.light},chipContainer:{height:"68px",overflowX:"scroll"},list:{overflow:"auto",maxHeight:"calc(100vh - 185px)"},listItemText:{display:"flex","& .MuiListItemText-secondary":{marginLeft:"1em"}}}}));function A(e){var t=J(),n=t.listItemChecked,r=t.chipContainer,i=t.list,o=t.listItemText,u=Object(c.useState)([]),l=Object(s.a)(u,2),d=l[0],m=l[1],g=Object(S.useRecoilValue)(N),k=Object(S.useRecoilValue)(B),C=Object(S.useRecoilValue)(R),_=Array.from(new Set(g.map((function(e){return e.category}))));return Object(a.jsxs)(b.a,{children:[Object(a.jsx)(b.a,{p:2,children:Object(a.jsx)(f.a,{align:"center",display:"block",component:j.a,to:"/list/".concat(C),children:"Fertig"})}),Object(a.jsx)(b.a,{p:1,display:"flex",justifyContent:"space-between",alignItems:"space-between",flexDirection:"column",flexWrap:"wrap",className:r,children:_.sort((function(e,t){return P.indexOf(e)-P.indexOf(t)})).map((function(e){return Object(a.jsx)(V.a,{icon:Object(a.jsx)(v.a,{}),label:e,color:d.includes(e)?"primary":"default",onClick:function(){return function(e){var t=d.includes(e)?d.filter((function(t){return t!==e})):[e];return m(t)}(e)},clickable:!0},e)}))}),Object(a.jsx)(O.a,{className:i,children:g.filter((function(e){return!(d.length>0)||d.includes(e.category)})).sort((function(e,t){return P.indexOf(e.category)-P.indexOf(t.category)})).map((function(e){var t,c=k.some((function(t){return t.id===e.id})),r=null===(t=k.find((function(t){return t.id===e.id})))||void 0===t?void 0:t.quantity;return Object(a.jsx)(q.a,{onSwipedLeft:function(){return function(e){var t=k.find((function(t){return t.id===e.id}));return 1==(null===t||void 0===t?void 0:t.quantity)?w({list_id:C,product_id:e.id,type:"item_removed"}):(null===t||void 0===t?void 0:t.quantity)>1?w({list_id:C,product_id:e.id,type:"quantity_dec"}):void 0}(e)},onSwipedRight:function(){return function(e){var t=k.find((function(t){return t.id===e.id}));return w(t?{list_id:C,product_id:e.id,type:"quantity_inc"}:{list_id:C,product_id:e.id,type:"item_added"})}(e)},trackMouse:!0,children:Object(a.jsxs)(h.a,{button:!0,focusVisibleClassName:c?n:"",className:Object(y.a)(c?n:""),children:[Object(a.jsx)(p.a,{children:Object(a.jsx)(v.a,{})}),Object(a.jsx)(x.a,{className:o,primary:e.name,secondary:c?r:""}),c&&Object(a.jsx)(G.a,{})]},e.id)})}))})]})}var H=n(91),U=n.n(H),Z=n(92),X=n.n(Z),$=n(198),Q=n(93),Y=n.n(Q),ee=n(94),te=n.n(ee),ne=n(70),ae=n.n(ne),ce=n(197),re=n(213),ie=n(214),oe=n(204),se=n(200),ue=n(201),le=n(199),de=n(211),je=n(205),be=function(){var e=Object(S.useRecoilValue)(B),t=Object(S.useRecoilState)(N),n=Object(s.a)(t,2),a=n[0],c=n[1];return[a,function(){fetch("".concat(k,"/products")).then((function(e){return e.json()})).then((function(t){var n=t.data.map((function(t){return{id:String(t.id),name:t.product_name,category:t.category,selected:e.some((function(e){return e.id==="".concat(t.id)}))}}));c(n)}))}]},he=function(){var e=Object(S.useRecoilState)(_),t=Object(s.a)(e,2),n=t[0],a=t[1];return[n,function(){fetch("".concat(k,"/lists")).then((function(e){return e.json()})).then((function(e){return a(e.data)}))}]},fe=Object(g.a)((function(e){return{root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},nested:{paddingLeft:e.spacing(4)},isDeleted:{backgroundColor:e.palette.secondary.dark}}}));function Oe(e){var t=fe(),n=r.a.useState(!0),c=Object(s.a)(n,2),i=c[0],o=c[1],u=r.a.useState(!1),l=Object(s.a)(u,2),d=l[0],f=l[1],m=r.a.useState(!1),v=Object(s.a)(m,2),g=v[0],y=v[1],k=r.a.useState(!1),S=Object(s.a)(k,2),N=S[0],_=S[1],R=r.a.useState(""),T=Object(s.a)(R,2),B=T[0],W=T[1],E=r.a.useState(""),L=Object(s.a)(E,2),P=L[0],D=L[1],M=r.a.useState(""),z=Object(s.a)(M,2),G=z[0],V=z[1],q=r.a.useState(""),J=Object(s.a)(q,2),A=J[0],H=J[1],Z=be(),Q=Object(s.a)(Z,2),ee=(Q[0],Q[1]),ne=he(),Oe=Object(s.a)(ne,2),pe=Oe[0],xe=Oe[1],me=function(){return f(!1)},ve=function(){y(!1)},ge=function(){var e=Object(K.a)(I.a.mark((function e(){var t;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(me(),B.trim()){e.next=3;break}return e.abrupt("return");case 3:return W(""),t={type:"list_added",name:B},e.next=7,w(t);case 7:return e.abrupt("return",xe());case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=function(){var e=Object(K.a)(I.a.mark((function e(){var t;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ve(),P.trim()){e.next=3;break}return e.abrupt("return");case 3:return D(""),t={type:"list_removed",list_id:P},xe(),e.next=8,w(t);case 8:return e.abrupt("return",xe());case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=Object(K.a)(I.a.mark((function e(){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_(!1),G.trim()){e.next=3;break}return e.abrupt("return");case 3:if(A.trim()){e.next=5;break}return e.abrupt("return");case 5:return V(""),H(""),e.next=9,C({newProductName:G,newProductCategory:A});case 9:return e.abrupt("return",ee());case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)(b.a,{className:t.root,children:[Object(a.jsxs)(O.a,{component:"nav","aria-label":"main mailbox folders",children:[Object(a.jsxs)(h.a,{button:!0,children:[Object(a.jsx)(p.a,{children:Object(a.jsx)(U.a,{})}),Object(a.jsx)(x.a,{onClick:function(){return f(!0)},primary:"Neuer Einkaufszettel"})]}),Object(a.jsxs)(h.a,{button:!0,onClick:function(){o(!i)},children:[Object(a.jsx)(p.a,{children:Object(a.jsx)(X.a,{})}),Object(a.jsx)(x.a,{primary:"Einkaufslisten"}),i?Object(a.jsx)(Y.a,{}):Object(a.jsx)(te.a,{})]}),Object(a.jsx)(ce.a,{in:i,timeout:"auto",unmountOnExit:!0,children:Object(a.jsx)(O.a,{component:"div",disablePadding:!0,children:pe.map((function(e){return Object(a.jsxs)(h.a,{component:j.a,to:"/list/".concat(e.id),button:!0,className:t.nested,children:[Object(a.jsx)(p.a,{children:Object(a.jsx)(ae.a,{})}),Object(a.jsx)(x.a,{primary:e.name})]},e.id)}))})})]}),Object(a.jsx)($.a,{}),Object(a.jsxs)(O.a,{component:"nav","aria-label":"secondary mailbox folders",children:[Object(a.jsx)(h.a,{button:!0,children:Object(a.jsx)(x.a,{onClick:function(){return y(!0)},primary:"L\xf6schen"})}),Object(a.jsx)(h.a,{button:!0,children:Object(a.jsx)(x.a,{onClick:function(){return _(!0)},primary:"Neues Produkt"})})]}),Object(a.jsxs)(ie.a,{open:d,onClose:me,"aria-labelledby":"form-dialog-title",children:[Object(a.jsx)(le.a,{id:"form-dialog-title",children:"Neue Liste"}),Object(a.jsxs)(se.a,{children:[Object(a.jsx)(ue.a,{children:"Bitte gib den Namen deiner Einkaufsliste ein."}),Object(a.jsx)(re.a,{autoFocus:!0,margin:"dense",id:"name",value:B,label:"Name",type:"name",fullWidth:!0,onChange:function(e){return W(e.target.value)}})]}),Object(a.jsxs)(oe.a,{children:[Object(a.jsx)(F.a,{onClick:me,color:"primary",children:"Zur\xfcck"}),Object(a.jsx)(F.a,{onClick:ge,color:"primary",children:"OK"})]})]}),Object(a.jsxs)(ie.a,{open:g,onClose:ve,"aria-labelledby":"form-dialog-title",children:[Object(a.jsx)(le.a,{id:"form-dialog-title",children:"Liste l\xf6schen"}),Object(a.jsxs)(se.a,{children:[Object(a.jsx)(ue.a,{children:"Welche Liste m\xf6chtest du l\xf6schen?"}),Object(a.jsx)(O.a,{children:pe.map((function(e){var n=P===e.id;return Object(a.jsxs)(h.a,{onClick:function(){return D(e.id)},button:!0,className:n?t.isDeleted:"",children:[Object(a.jsx)(p.a,{children:Object(a.jsx)(ae.a,{})}),Object(a.jsx)(x.a,{primary:e.name})]},e.id)}))})]}),Object(a.jsxs)(oe.a,{children:[Object(a.jsx)(F.a,{onClick:ve,color:"primary",children:"Zur\xfcck"}),Object(a.jsx)(F.a,{onClick:ye,color:"primary",children:"OK"})]})]}),Object(a.jsxs)(ie.a,{open:N,onClose:_,"aria-labelledby":"form-dialog-title",children:[Object(a.jsx)(le.a,{id:"form-dialog-title",children:"Neues Produkt"}),Object(a.jsxs)(se.a,{children:[Object(a.jsx)(ue.a,{children:"Bitte gib den Namen des neuen Produkts ein."}),Object(a.jsx)(re.a,{autoFocus:!0,margin:"dense",id:"name",value:G,label:"Name",type:"name",fullWidth:!0,onChange:function(e){return V(e.target.value)}}),Object(a.jsx)(ue.a,{children:"Bitte gib die Kategorie des neuen Produkts an"}),Object(a.jsxs)(de.a,{id:"category",value:A,onChange:function(e){var t=e.target.value;H(t)},children:[Object(a.jsx)(je.a,{value:"Obst",children:"Obst"}),Object(a.jsx)(je.a,{value:"Gem\xfcse",children:"Gem\xfcse"}),Object(a.jsx)(je.a,{value:"K\xfchlwaren",children:"K\xfchlwaren"}),Object(a.jsx)(je.a,{value:"Fleisch",children:"Fleisch"}),Object(a.jsx)(je.a,{value:"TK",children:"TK"}),Object(a.jsx)(je.a,{value:"Konserven",children:"Konserven"}),Object(a.jsx)(je.a,{value:"Trockenware",children:"Trockenware"}),Object(a.jsx)(je.a,{value:"W\xfcrzwaren",children:"W\xfcrzwaren"}),Object(a.jsx)(je.a,{value:"Backwaren",children:"Backwaren"}),Object(a.jsx)(je.a,{value:"Backzutaten",children:"Backzutaten"}),Object(a.jsx)(je.a,{value:"Getr\xe4nke",children:"Getr\xe4nke"}),Object(a.jsx)(je.a,{value:"Snacks",children:"Snacks"}),Object(a.jsx)(je.a,{value:"Drogerie",children:"Drogerie"})]})]}),Object(a.jsxs)(oe.a,{children:[Object(a.jsx)(F.a,{onClick:function(){return _(!1)},color:"primary",children:"Zur\xfcck"}),Object(a.jsx)(F.a,{onClick:ke,color:"primary",children:"OK"})]})]})]})}var pe=n(206),xe=n(207),me=n(37),ve=n(208),ge=n(95),ye=n.n(ge),ke=Object(g.a)((function(e){return{menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));function we(){var e=ke();return Object(a.jsx)(b.a,{flexGrow:1,children:Object(a.jsx)(pe.a,{position:"static",children:Object(a.jsxs)(xe.a,{children:[Object(a.jsx)(ve.a,{onClick:function(){return Object(j.c)("/menu")},edge:"start",className:e.menuButton,color:"inherit","aria-label":"menu",children:Object(a.jsx)(ye.a,{})}),Object(a.jsx)(me.a,{variant:"h6",className:e.title,children:"Einkaufsliste"})]})})})}var Ce=Object(g.a)((function(){return{page:{boxSizing:"border-box",margin:"0",padding:"0",maxHeight:"100vh",position:"relative",paddingBottom:"10vh"}}}));function Se(e){var t=Ce().page;return Object(a.jsxs)(b.a,{className:t,children:[Object(a.jsx)(we,{}),Object(a.jsxs)(j.b,{children:[Object(a.jsx)(M,{path:"/list/:id"}),Object(a.jsx)(A,{path:"/list/:id/edit"}),Object(a.jsx)(Oe,{path:"/menu"})]})]})}n(148);var Ne=Object(u.a)({palette:{primary:{main:"#57DBBE",light:"#80FFE3"},secondary:{main:"#915540",light:"#DF9379"}},typography:{fontFamily:"\n      Roboto Mono,\n      Roboto,\n      sans-serif\n      "}});Ne=Object(l.a)(Ne);var _e=function(){var e=be(),t=Object(s.a)(e,2),n=(t[0],t[1]),r=he(),i=Object(s.a)(r,2),o=(i[0],i[1]);return L(),Object(c.useEffect)((function(){n(),o()}),[]),Object(a.jsx)(d.a,{theme:Ne,children:Object(a.jsx)(Se,{})})},Re=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Te(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(S.RecoilRoot,{children:Object(a.jsx)(_e,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Re?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Te(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Te(t,e)}))}}()}},[[149,1,2]]]);
//# sourceMappingURL=main.36822a45.chunk.js.map